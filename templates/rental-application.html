{% extends "layout.html" %}

{% block title %}Newfound Living - Rental Application{% endblock %}

{% block content %}
  <h1>Rental Application</h1>
  <form id="rental-form" action="https://formspree.io/f/xldnwbqq" method="POST" enctype="multipart/form-data" novalidate>
    <!-- Property Details -->
    <fieldset class="form-section">
      <h2>Property Details</h2>
      <label for="property-address">Property Address</label>
      <input type="text" id="property-address" name="property_address" required placeholder="e.g., 123 Main St">
      <div class="checkbox-group">
        <label><input type="checkbox" name="rental_unit_main" value="Main Unit"> Main Unit</label>
        <label><input type="checkbox" name="rental_unit_basement" value="Basement Apartment"> Basement Apartment</label>
        <label>
          <input type="checkbox" name="rental_unit_other" value="Other"> Other:
          <input type="text" name="rental_unit_other_text" placeholder="Specify">
        </label>
      </div>
      <label for="move-in-date">Desired Move-in Date</label>
      <input type="date" id="move-in-date" name="move_in_date" required>
    </fieldset>

    <!-- Applicant Info -->
    <fieldset class="form-section">
      <h2>Applicant Information</h2>
      <div class="two-columns">
        <div>
          <label for="full-name">Full Name</label>
          <input type="text" id="full-name" name="full_name" required>
        </div>
        <div>
          <label for="dob">Date of Birth</label>
          <input type="date" id="dob" name="date_of_birth" required>
        </div>
      </div>
      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" name="phone_number" required>
      <label for="email">Email Address</label>
      <input type="email" id="email" name="email_address" required>
      <label for="current-address">Current Address</label>
      <input type="text" id="current-address" name="current_address" required>
      <div class="two-columns">
        <div>
          <label for="landlord-name">Landlord’s Name</label>
          <input type="text" id="landlord-name" name="landlord_name">
        </div>
        <div>
          <label for="landlord-phone">Landlord’s Phone</label>
          <input type="tel" id="landlord-phone" name="landlord_phone">
        </div>
      </div>
      <label for="reason-leaving">Reason for Leaving</label>
      <textarea id="reason-leaving" name="reason_for_leaving"></textarea>
      <label for="length-tenancy">Length of Tenancy</label>
      <input type="text" id="length-tenancy" name="length_of_tenancy" placeholder="e.g., 2 years">
    </fieldset>

    <!-- Employment -->
    <fieldset class="form-section">
      <h2>Employment / Income</h2>
      <label for="employer-name">Employer Name</label>
      <input type="text" id="employer-name" name="employer_name" required>
      <label for="position">Position</label>
      <input type="text" id="position" name="position" required>
      <label for="monthly-income">Monthly Income (Net)</label>
      <input type="number" id="monthly-income" name="monthly_income" required placeholder="e.g., 3000">
      <label for="employment-length">Length of Employment</label>
      <input type="text" id="employment-length" name="length_of_employment" placeholder="e.g., 3 years">
      <label class="checkbox-inline">
        <input type="checkbox" name="proof_of_income" value="Yes"> Proof of income attached
      </label>
      <label for="income-proof-file" class="file-label">Upload proof of income</label>
      <input type="file" id="income-proof-file" name="income_proof_file">
    </fieldset>
    <div class="form-actions">
      <button type="submit" class="btn-submit">Submit Application</button>
    </div>
  </form>
  <div id="thank-you">Thank you! Your application has been submitted.</div>
  <script>
    const rentalForm = document.getElementById('rental-form');
    const thankYou = document.getElementById('thank-you');
    rentalForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      const formData = new FormData(rentalForm);
      try {
        await fetch(rentalForm.action, {
          method: 'POST',
          body: formData,
          headers: { 'Accept': 'application/json' }
        });
        rentalForm.reset();
        thankYou.style.display = 'block';
      } catch (err) {
        alert('Submission failed. Please try again.');
      }
    });
  </script>
{% endblock %}
